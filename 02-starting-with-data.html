<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><title>Data Analysis and Visualisation in R for Ecologists: Starting with data</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="assets/styles.css"><script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png"><link rel="manifest" href="site.webmanifest"><link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"></head><body>
    <header id="top" class="navbar navbar-expand-md navbar-light bg-white top-nav data"><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-6">
      <div class="large-logo">
        <img alt="Data Carpentry" src="assets/images/data-logo.svg"></div>
    </div>
    <div class="selector-container">
      
      
      <div class="dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1"><li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/02-starting-with-data.html';">Instructor View</button></li>
        </ul></div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl navbar-light bg-white bottom-nav data" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Data Carpentry" src="assets/images/data-logo-sm.svg"></div>
    <div class="lesson-title-md">
      Data Analysis and Visualisation in R for Ecologists
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="search button" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0"><li class="nav-item">
          <span class="lesson-title">
            Data Analysis and Visualisation in R for Ecologists
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown"><li><a class="dropdown-item" href="reference.html">Learners' Reference</a></li>
          </ul></li>
      </ul></div>
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled><input class="form-control me-2 searchbox" type="search" placeholder="Search" aria-label="Search"><button class="btn btn-outline-success tablet-search-button" type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="search button"></i>
        </button>
      </fieldset></form>
  </div><!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Data Analysis and Visualisation in R for Ecologists
</div>

<aside class="col-md-12 lesson-progress"><div style="width: 33%" class="percentage">
    33%
  </div>
  <div class="progress data">
    <div class="progress-bar data" role="progressbar" style="width: 33%" aria-valuenow="33" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/02-starting-with-data.html">Instructor View</a>
                      </div>
                    </div>
                  </div><!--/div.accordion-item-->
                </div><!--/div.accordion-flush-->
              </div><!--div.sidenav-view-selector -->
            </div><!--/div.col -->
      
            <hr></div><!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Data Analysis and Visualization in R for Ecologists</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="00-before-we-start.html">1. Before we start</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="01-intro-to-r.html">2. Introduction to R</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlushcurrent">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-headingcurrent">
      <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapsecurrent" aria-expanded="true" aria-controls="flush-collapsecurrent">
        <span class="visually-hidden">Current Chapter</span>
        <span class="current-chapter">
        3. Starting with data
        </span>
      </button>
    </div><!--/div.accordion-header-->
        
    <div id="flush-collapsecurrent" class="accordion-collapse collapse show" aria-labelledby="flush-headingcurrent" data-bs-parent="#accordionFlushcurrent">
      <div class="accordion-body">
        <ul><li><a href="#loading-the-survey-data">Loading the survey data</a></li>
<li><a href="#what-are-data-frames">What are data frames?</a></li>
<li><a href="#inspecting-data-frames">Inspecting data frames</a></li>
<li><a href="#indexing-and-subsetting-data-frames">Indexing and subsetting data frames</a></li>
<li><a href="#factors">Factors</a></li>
<li><a href="#formatting-dates">Formatting dates</a></li>
        </ul></div><!--/div.accordion-body-->
    </div><!--/div.accordion-collapse-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="03-dplyr.html">4. Manipulating, analyzing and exporting data with tidyverse</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush6">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading6">
        <a href="04-visualization-ggplot2.html">5. Data visualization with ggplot2</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush7">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading7">
        <a href="05-r-and-databases.html">6. SQL databases and R</a>
    </div><!--/div.accordion-header-->
        
  </div><!--/div.accordion-item-->
</div><!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width"><div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul><li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Learners' Reference</a></li>
                    </ul></div>
                </div>
              </div>
            </div>
            <hr class="half-width resources"><a href="aio.html">See all in one page</a>
            

            <hr class="d-none d-sm-block d-md-none"><div class="d-grid gap-1">
            
            </div>
          </div><!-- /div.accordion -->
        </div><!-- /div.sidebar-inner -->
      </nav></div><!-- /div.sidebar -->
  </div><!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-instructor.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <nav class="lesson-content mx-md-4" aria-label="Previous and Next Chapter"><!-- content for small screens --><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-intro-to-r.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-dplyr.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-intro-to-r.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to R
        </a>
        <a class="chapter-link float-end" href="03-dplyr.html" rel="next">
          Next: Manipulating,... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
      <hr></nav><main id="main-content" class="main-content"><div class="container lesson-content">
        <h1>Starting with data</h1>
        <p>Last updated on 2024-03-12 |
        
        <a href="https://github.com/datacarpentry/R-ecology-lesson/edit/main/episodes/02-starting-with-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
        
        
        
        <div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>

        

<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul><li>What is a data.frame?</li>
<li>How can I read a complete csv file into R?</li>
<li>How can I get basic summary information about my dataset?</li>
<li>How can extract specific information from a dataframe?</li>
<li>What are factors, and how are they different from other
datatypes?</li>
<li>How can I rename factors?</li>
<li>How are dates represented in R and how can I change the format?</li>
</ul></div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul><li>Load external data from a .csv file into a data frame.</li>
<li>Install and load packages.</li>
<li>Describe what a data frame is.</li>
<li>Summarize the contents of a data frame.</li>
<li>Use indexing to subset specific portions of data frames.</li>
<li>Describe what a factor is.</li>
<li>Convert between strings and factors.</li>
<li>Reorder and rename factors.</li>
<li>Change how character strings are handled in a data frame.</li>
<li>Format dates.</li>
</ul></div>
</div>
</div>
</div>
</div>
<section id="loading-the-survey-data"><h2 class="section-heading">Loading the survey data<a class="anchor" aria-label="anchor" href="#loading-the-survey-data"></a>
</h2>
<hr class="half-width"><p>We are investigating the animal species diversity and weights found
within plots at our study site. The dataset is stored as a comma
separated value (CSV) file. Each row holds information for a single
animal, and the columns represent:</p>
<table class="table"><thead><tr class="header"><th>Column</th>
<th>Description</th>
</tr></thead><tbody><tr class="odd"><td>record_id</td>
<td>Unique id for the observation</td>
</tr><tr class="even"><td>month</td>
<td>month of observation</td>
</tr><tr class="odd"><td>day</td>
<td>day of observation</td>
</tr><tr class="even"><td>year</td>
<td>year of observation</td>
</tr><tr class="odd"><td>plot_id</td>
<td>ID of a particular experimental plot of land</td>
</tr><tr class="even"><td>species_id</td>
<td>2-letter code</td>
</tr><tr class="odd"><td>sex</td>
<td>sex of animal (“M”, “F”)</td>
</tr><tr class="even"><td>hindfoot_length</td>
<td>length of the hindfoot in mm</td>
</tr><tr class="odd"><td>weight</td>
<td>weight of the animal in grams</td>
</tr><tr class="even"><td>genus</td>
<td>genus of animal</td>
</tr><tr class="odd"><td>species</td>
<td>species of animal</td>
</tr><tr class="even"><td>taxon</td>
<td>e.g. Rodent, Reptile, Bird, Rabbit</td>
</tr><tr class="odd"><td>plot_type</td>
<td>type of plot</td>
</tr></tbody></table><div class="section level3">
<h3 id="downloading-the-data">Downloading the data<a class="anchor" aria-label="anchor" href="#downloading-the-data"></a></h3>
<p>We created the folder that will store the downloaded data
(<code>data_raw</code>) in the chapter <a href="https://datacarpentry.org/R-ecology-lesson/00-before-we-start.html#Organizing_your_working_directory" class="external-link">“Before
we start”</a>. If you skipped that part, it may be a good idea to have a
look now, to make sure your working directory is set up properly.</p>
<p>We are going to use the R function <code>download.file()</code> to
download the CSV file that contains the survey data from Figshare, and
we will use <code>read_csv()</code> to load the content of the CSV file
into R.</p>
<p>Inside the <code>download.file</code> command, the first entry is a
character string with the source URL (“<a href="https://ndownloader.figshare.com/files/2292169" class="external-link uri">https://ndownloader.figshare.com/files/2292169</a>”). This
source URL downloads a CSV file from figshare. The text after the comma
(“data_raw/portal_data_joined.csv”) is the destination of the file on
your local machine. You’ll need to have a folder on your machine called
“data_raw” where you’ll download the file. So this command downloads a
file from Figshare, names it “portal_data_joined.csv” and adds it to a
preexisting folder named “data_raw”.</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">download.file</span><span class="op">(</span>url <span class="op">=</span> <span class="st">"https://ndownloader.figshare.com/files/2292169"</span>,</span>
<span>              destfile <span class="op">=</span> <span class="st">"data_raw/portal_data_joined.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="reading-the-data-into-r">Reading the data into R<a class="anchor" aria-label="anchor" href="#reading-the-data-into-r"></a></h3>
<p>The file has now been downloaded to the destination you specified,
but R has not yet loaded the data from the file into memory. To do this,
we can use the <code>read_csv()</code> function from the
<strong><code>tidyverse</code></strong> package.</p>
<p>Packages in R are basically sets of additional functions that let you
do more stuff. The functions we’ve been using so far, like
<code>round()</code>, <code>sqrt()</code>, or <code>c()</code> come
built into R. Packages give you access to additional functions beyond
base R. A similar function to <code>read_csv()</code> from the tidyverse
package is <code>read.csv()</code> from base R. We don’t have time to
cover their differences but notice that the exact spelling determines
which function is used. Before you use a package for the first time you
need to install it on your machine, and then you should import it in
every subsequent R session when you need it.</p>
<p>To install the <strong><code>tidyverse</code></strong> package, we
can type <code>install.packages("tidyverse")</code> straight into the
console. In fact, it’s better to write this in the console than in our
script for any package, as there’s no need to re-install packages every
time we run the script. Then, to load the package type:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## load the tidyverse packages, incl. dplyr</span></span>
<span><span class="kw">library</span><span class="op">(</span><span class="va">tidyverse</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we can use the functions from the
<strong><code>tidyverse</code></strong> package. Let’s use
<code>read_csv()</code> to read the data into a data frame (we will
learn more about data frames later):</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="st">"data_raw/portal_data_joined.csv"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; Rows: 34786 Columns: 13</span></span>
<span><span class="co">#&gt; ── Column specification ────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Delimiter: ","</span></span>
<span><span class="co">#&gt; chr (6): species_id, sex, genus, species, taxa, plot_type</span></span>
<span><span class="co">#&gt; dbl (7): record_id, month, day, year, plot_id, hindfoot_length, weight</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span></code></pre>
</div>
<p>When you execute <code>read_csv</code> on a data file, it looks
through the first 1000 rows of each column and guesses its data type.
For example, in this dataset, <code>read_csv()</code> reads
<code>weight</code> as <code>col_double</code> (a numeric data type),
and <code>species</code> as <code>col_character</code>. You have the
option to specify the data type for a column manually by using the
<code>col_types</code> argument in <code>read_csv</code>.</p>
<div id="note" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h3>
<div class="callout-content">
<p><code>read_csv()</code> assumes that fields are delineated by commas.
However, in several countries, the comma is used as a decimal separator
and the semicolon (;) is used as a field delineator. If you want to read
in this type of files in R, you can use the <code>read_csv2()</code>
function. It behaves like <code>read_csv()</code> but uses different
parameters for the decimal and the field separators. There is also the
<code>read_tsv()</code> for tab separated data files and
<code>read_delim()</code> for less common formats. Check out the help
for <code>read_csv()</code> by typing <code>?read_csv</code> to learn
more.</p>
<p>In addition to the above versions of the csv format, you should
develop the habits of looking at and recording some parameters of your
csv files. For instance, the character encoding, control characters used
for line ending, date format (if the date is not split into three
variables), and the presence of unexpected <a href="https://en.wikipedia.org/wiki/Newline" class="external-link">newlines</a> are important
characteristics of your data files. Those parameters will ease up the
import step of your data in R.</p>
</div>
</div>
</div>
<p>We can see the contents of the first few lines of the data by typing
its name: <code>surveys</code>. By default, this will show you as many
rows and columns of the data as fit on your screen. If you wanted the
first 50 rows, you could type <code>print(surveys, n = 50)</code></p>
<p>We can also extract the first few lines of this data using the
function <code>head()</code>:</p>
<div class="codewrapper sourceCode" id="cb5">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; # A tibble: 6 × 13</span></span>
<span><span class="co">#&gt;   record_id month   day  year plot_id species_id sex   hindfoot_length weight</span></span>
<span><span class="co">#&gt;       &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;           &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1         1     7    16  1977       2 NL         M                  32     NA</span></span>
<span><span class="co">#&gt; 2        72     8    19  1977       2 NL         M                  31     NA</span></span>
<span><span class="co">#&gt; 3       224     9    13  1977       2 NL         &lt;NA&gt;               NA     NA</span></span>
<span><span class="co">#&gt; 4       266    10    16  1977       2 NL         &lt;NA&gt;               NA     NA</span></span>
<span><span class="co">#&gt; 5       349    11    12  1977       2 NL         &lt;NA&gt;               NA     NA</span></span>
<span><span class="co">#&gt; 6       363    11    12  1977       2 NL         &lt;NA&gt;               NA     NA</span></span>
<span><span class="co">#&gt; # ℹ 4 more variables: genus &lt;chr&gt;, species &lt;chr&gt;, taxa &lt;chr&gt;, plot_type &lt;chr&gt;</span></span></code></pre>
</div>
<p>Unlike the <code>print()</code> function, <code>head()</code> returns
the extracted data. You could use it to assign the first 100 rows of
<code>surveys</code> to an object using
<code>surveys_sample &lt;- head(surveys, 100)</code>. This can be useful
if you want to try out complex computations on a subset of your data
before you apply them to the whole data set. There is a similar function
that lets you extract the last few lines of the data set. It is called
(you might have guessed it) <code>tail()</code>.</p>
<p>To open the dataset in RStudio’s Data Viewer, use the
<code>view()</code> function:</p>
<div class="codewrapper sourceCode" id="cb7">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">view</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre>
</div>
<div id="note-1" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="note-1" class="callout-inner">
<h3 class="callout-title">Note<a class="anchor" aria-label="anchor" href="#note-1"></a>
</h3>
<div class="callout-content">
<p>There are two functions for viewing which are case-sensitive. Using
<code>view()</code> with a lowercase ‘v’ is part of tidyverse, whereas
using <code>View()</code> with an uppercase ‘V’ is loaded through base R
in the <code>utils</code> package.</p>
</div>
</div>
</div>
</div>
</section><section id="what-are-data-frames"><h2 class="section-heading">What are data frames?<a class="anchor" aria-label="anchor" href="#what-are-data-frames"></a>
</h2>
<hr class="half-width"><p>When we loaded the data into R, it got stored as an object of class
<code>tibble</code>, which is a special kind of data frame (the
difference is not important for our purposes, but you can learn more
about tibbles <a href="https://tibble.tidyverse.org/" class="external-link">here</a>). Data
frames are the <em>de facto</em> data structure for most tabular data,
and what we use for statistics and plotting. Data frames can be created
by hand, but most commonly they are generated by functions like
<code>read_csv()</code>; in other words, when importing spreadsheets
from your hard drive or the web.</p>
<p>A data frame is the representation of data in the format of a table
where the columns are vectors that all have the same length. Because
columns are vectors, each column must contain a single type of data
(e.g., characters, integers, factors). For example, here is a figure
depicting a data frame comprising a numeric, a character, and a logical
vector.</p>
<figure><img src="./fig/data-frame.svg" class="figure mx-auto d-block"></figure><p>We can see this also when inspecting the <b>str</b>ucture of a data
frame with the function <code>str()</code>:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre>
</div>
</section><section id="inspecting-data-frames"><h2 class="section-heading">Inspecting data frames<a class="anchor" aria-label="anchor" href="#inspecting-data-frames"></a>
</h2>
<hr class="half-width"><p>We already saw how the functions <code>head()</code> and
<code>str()</code> can be useful to check the content and the structure
of a data frame. Here is a non-exhaustive list of functions to get a
sense of the content/structure of the data. Let’s try them out!</p>
<ul><li>
<p>Size:</p>
<ul><li>
<code>dim(surveys)</code> - returns a vector with the number of rows
in the first element, and the number of columns as the second element
(the <strong>dim</strong>ensions of the object)</li>
<li>
<code>nrow(surveys)</code> - returns the number of rows</li>
<li>
<code>ncol(surveys)</code> - returns the number of columns</li>
</ul></li>
<li>
<p>Content:</p>
<ul><li>
<code>head(surveys)</code> - shows the first 6 rows</li>
<li>
<code>tail(surveys)</code> - shows the last 6 rows</li>
</ul></li>
<li>
<p>Names:</p>
<ul><li>
<code>names(surveys)</code> - returns the column names (synonym of
<code>colnames()</code> for <code>data.frame</code> objects)</li>
<li>
<code>rownames(surveys)</code> - returns the row names</li>
</ul></li>
<li>
<p>Summary:</p>
<ul><li>
<code>str(surveys)</code> - structure of the object and information
about the class, length and content of each column</li>
<li>
<code>summary(surveys)</code> - summary statistics for each
column</li>
</ul></li>
</ul><p>Note: most of these functions are “generic”, they can be used on
other types of objects besides <code>data.frame</code>.</p>
<div id="challenge" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge"></a>
</h3>
<div class="callout-content">
<p>Based on the output of <code>str(surveys)</code>, can you answer the
following questions?</p>
<ul><li>What is the class of the object <code>surveys</code>?</li>
<li>How many rows and how many columns are in this object?</li>
</ul></div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1">Show me the solution</h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" data-bs-parent="#accordionSolution1" aria-labelledby="headingSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; spc_tbl_ [34,786 × 13] (S3: spec_tbl_df/tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ record_id      : num [1:34786] 1 72 224 266 349 363 435 506 588 661 ...</span></span>
<span><span class="co">#&gt;  $ month          : num [1:34786] 7 8 9 10 11 11 12 1 2 3 ...</span></span>
<span><span class="co">#&gt;  $ day            : num [1:34786] 16 19 13 16 12 12 10 8 18 11 ...</span></span>
<span><span class="co">#&gt;  $ year           : num [1:34786] 1977 1977 1977 1977 1977 ...</span></span>
<span><span class="co">#&gt;  $ plot_id        : num [1:34786] 2 2 2 2 2 2 2 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ species_id     : chr [1:34786] "NL" "NL" "NL" "NL" ...</span></span>
<span><span class="co">#&gt;  $ sex            : chr [1:34786] "M" "M" NA NA ...</span></span>
<span><span class="co">#&gt;  $ hindfoot_length: num [1:34786] 32 31 NA NA NA NA NA NA NA NA ...</span></span>
<span><span class="co">#&gt;  $ weight         : num [1:34786] NA NA NA NA NA NA NA NA 218 NA ...</span></span>
<span><span class="co">#&gt;  $ genus          : chr [1:34786] "Neotoma" "Neotoma" "Neotoma" "Neotoma" ...</span></span>
<span><span class="co">#&gt;  $ species        : chr [1:34786] "albigula" "albigula" "albigula" "albigula" ...</span></span>
<span><span class="co">#&gt;  $ taxa           : chr [1:34786] "Rodent" "Rodent" "Rodent" "Rodent" ...</span></span>
<span><span class="co">#&gt;  $ plot_type      : chr [1:34786] "Control" "Control" "Control" "Control" ...</span></span>
<span><span class="co">#&gt;  - attr(*, "spec")=</span></span>
<span><span class="co">#&gt;   .. cols(</span></span>
<span><span class="co">#&gt;   ..   record_id = col_double(),</span></span>
<span><span class="co">#&gt;   ..   month = col_double(),</span></span>
<span><span class="co">#&gt;   ..   day = col_double(),</span></span>
<span><span class="co">#&gt;   ..   year = col_double(),</span></span>
<span><span class="co">#&gt;   ..   plot_id = col_double(),</span></span>
<span><span class="co">#&gt;   ..   species_id = col_character(),</span></span>
<span><span class="co">#&gt;   ..   sex = col_character(),</span></span>
<span><span class="co">#&gt;   ..   hindfoot_length = col_double(),</span></span>
<span><span class="co">#&gt;   ..   weight = col_double(),</span></span>
<span><span class="co">#&gt;   ..   genus = col_character(),</span></span>
<span><span class="co">#&gt;   ..   species = col_character(),</span></span>
<span><span class="co">#&gt;   ..   taxa = col_character(),</span></span>
<span><span class="co">#&gt;   ..   plot_type = col_character()</span></span>
<span><span class="co">#&gt;   .. )</span></span>
<span><span class="co">#&gt;  - attr(*, "problems")=&lt;externalptr&gt;</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## * class: data frame</span></span>
<span><span class="co">## * how many rows: 34786,  how many columns: 13</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="indexing-and-subsetting-data-frames"><h2 class="section-heading">Indexing and subsetting data frames<a class="anchor" aria-label="anchor" href="#indexing-and-subsetting-data-frames"></a>
</h2>
<hr class="half-width"><p>Our survey data frame has rows and columns (it has 2 dimensions), if
we want to extract some specific data from it, we need to specify the
“coordinates” we want from it. Row numbers come first, followed by
column numbers. However, note that different ways of specifying these
coordinates lead to results with different classes.</p>
<div class="codewrapper sourceCode" id="cb12">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># We can extract specific values by specifying row and column indices</span></span>
<span><span class="co"># in the format: </span></span>
<span><span class="co"># data_frame[row_index, column_index]</span></span>
<span><span class="co"># For instance, to extract the first row and column from surveys:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># First row, sixth column:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">6</span><span class="op">]</span>   </span>
<span></span>
<span><span class="co"># We can also use shortcuts to select a number of rows or columns at once</span></span>
<span><span class="co"># To select all columns, leave the column index blank</span></span>
<span><span class="co"># For instance, to select all columns for the first row:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># The same shortcut works for rows --</span></span>
<span><span class="co"># To select the first column across all rows:</span></span>
<span><span class="va">surveys</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># An even shorter way to select first column across all rows:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="co"># No comma! </span></span>
<span></span>
<span><span class="co"># To select multiple rows or columns, use vectors!</span></span>
<span><span class="co"># To select the first three rows of the 5th and 6th column</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fu">c</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">]</span> </span>
<span></span>
<span><span class="co"># We can use the : operator to create those vectors for us:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span> </span>
<span></span>
<span><span class="co"># This is equivalent to head_surveys &lt;- head(surveys)</span></span>
<span><span class="va">head_surveys</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># As we've seen, when working with tibbles </span></span>
<span><span class="co"># subsetting with single square brackets ("[]") always returns a data frame.</span></span>
<span><span class="co"># If you want a vector, use double square brackets ("[[]]")</span></span>
<span></span>
<span><span class="co"># For instance, to get the first column as a vector:</span></span>
<span><span class="va">surveys</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># To get the first value in our data frame:</span></span>
<span><span class="va">surveys</span><span class="op">[[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<p><code>:</code> is a special function that creates numeric vectors of
integers in increasing or decreasing order, test <code>1:10</code> and
<code>10:1</code> for instance.</p>
<p>You can also exclude certain indices of a data frame using the
“<code>-</code>” sign:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span><span class="op">[</span>, <span class="op">-</span><span class="fl">1</span><span class="op">]</span>                 <span class="co"># The whole data frame, except the first column</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fu">nrow</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># Equivalent to head(surveys)</span></span></code></pre>
</div>
<p>Data frames can be subset by calling indices (as shown previously),
but also by calling their column names directly:</p>
<div class="codewrapper sourceCode" id="cb14">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># As before, using single brackets returns a data frame:</span></span>
<span><span class="va">surveys</span><span class="op">[</span><span class="st">"species_id"</span><span class="op">]</span></span>
<span><span class="va">surveys</span><span class="op">[</span>, <span class="st">"species_id"</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Double brackets returns a vector:</span></span>
<span><span class="va">surveys</span><span class="op">[[</span><span class="st">"species_id"</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># We can also use the $ operator with column names instead of double brackets</span></span>
<span><span class="co"># This returns a vector:</span></span>
<span><span class="va">surveys</span><span class="op">$</span><span class="va">species_id</span></span></code></pre>
</div>
<p>In RStudio, you can use the autocompletion feature to get the full
and correct names of the columns.</p>
<div id="challenge-1" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-1" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-1"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>Create a <code>data.frame</code> (<code>surveys_200</code>)
containing only the data in row 200 of the <code>surveys</code>
dataset.</p></li>
<li><p>Notice how <code>nrow()</code> gave you the number of rows in a
<code>data.frame</code>?</p></li>
</ol><ul><li>Use that number to pull out just that last row from the
<code>surveys</code> dataset.</li>
<li>Compare that with what you see as the last row using
<code>tail()</code> to make sure it’s meeting expectations.</li>
<li>Pull out that last row using <code>nrow()</code> instead of the row
number.</li>
<li>Create a new data frame (<code>surveys_last</code>) from that last
row.</li>
</ul><ol start="3" style="list-style-type: decimal"><li><p>Use <code>nrow()</code> to extract the row that is in the middle
of the data frame. Store the content of this row in an object named
<code>surveys_middle</code>.</p></li>
<li><p>Combine <code>nrow()</code> with the <code>-</code> notation
above to reproduce the behavior of <code>head(surveys)</code>, keeping
just the first through 6th rows of the surveys dataset.</p></li>
</ol></div>
</div>
</div>
<div id="accordionSolution2" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution2" aria-expanded="false" aria-controls="collapseSolution2">
  <h4 class="accordion-header" id="headingSolution2">Show me the solution</h4>
</button>
<div id="collapseSolution2" class="accordion-collapse collapse" data-bs-parent="#accordionSolution2" aria-labelledby="headingSolution2">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## 1.</span></span>
<span><span class="va">surveys_200</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="fl">200</span>, <span class="op">]</span></span>
<span><span class="co">## 2.</span></span>
<span><span class="co"># Saving `n_rows` to improve readability and reduce duplication</span></span>
<span><span class="va">n_rows</span> <span class="op">&lt;-</span> <span class="fu">nrow</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span>
<span><span class="va">surveys_last</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="va">n_rows</span>, <span class="op">]</span></span>
<span><span class="co">## 3.</span></span>
<span><span class="va">surveys_middle</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="va">n_rows</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">]</span></span>
<span><span class="co">## 4.</span></span>
<span><span class="va">surveys_head</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="op">-</span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="va">n_rows</span><span class="op">)</span>, <span class="op">]</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
</section><section id="factors"><h2 class="section-heading">Factors<a class="anchor" aria-label="anchor" href="#factors"></a>
</h2>
<hr class="half-width"><p>When we did <code>str(surveys)</code> we saw that several of the
columns consist of integers. The columns <code>genus</code>,
<code>species</code>, <code>sex</code>, <code>plot_type</code>, …
however, are of the class <code>character</code>. Arguably, these
columns contain categorical data, that is, they can only take on a
limited number of values.</p>
<p>R has a special class for working with categorical data, called
<code>factor</code>. Factors are very useful and actually contribute to
making R particularly well suited to working with data. So we are going
to spend a little time introducing them.</p>
<p>Once created, factors can only contain a pre-defined set of values,
known as <em>levels</em>. Factors are stored as integers associated with
labels and they can be ordered or unordered. While factors look (and
often behave) like character vectors, they are actually treated as
integer vectors by R. So you need to be very careful when treating them
as strings.</p>
<p>When importing a data frame with <code>read_csv()</code>, the columns
that contain text are not automatically coerced (=converted) into the
<code>factor</code> data type, but once we have loaded the data we can
do the conversion using the <code>factor()</code> function:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span><span class="op">$</span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<p>We can see that the conversion has worked by using the
<code>summary()</code> function again. This produces a table with the
counts for each factor level:</p>
<div class="codewrapper sourceCode" id="cb17">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<p>By default, R always sorts levels in alphabetical order. For
instance, if you have a factor with 2 levels:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span>, <span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<p>R will assign <code>1</code> to the level <code>"female"</code> and
<code>2</code> to the level <code>"male"</code> (because <code>f</code>
comes before <code>m</code>, even though the first element in this
vector is <code>"male"</code>). You can see this by using the function
<code>levels()</code> and you can find the number of levels using
<code>nlevels()</code>:</p>
<div class="codewrapper sourceCode" id="cb19">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="fu">nlevels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<p>Sometimes, the order of the factors does not matter, other times you
might want to specify the order because it is meaningful (e.g., “low”,
“medium”, “high”), it improves your visualization, or it is required by
a particular type of analysis. Here, one way to reorder our levels in
the <code>sex</code> vector would be:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="co"># current order</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] male   female female male  </span></span>
<span><span class="co">#&gt; Levels: female male</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb22">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">sex</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"male"</span>, <span class="st">"female"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sex</span> <span class="co"># after re-ordering</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] male   female female male  </span></span>
<span><span class="co">#&gt; Levels: male female</span></span></code></pre>
</div>
<p>In R’s memory, these factors are represented by integers (1, 2, 3),
but are more informative than integers because factors are self
describing: <code>"female"</code>, <code>"male"</code> is more
descriptive than <code>1</code>, <code>2</code>. Which one is “male”?
You wouldn’t be able to tell just from the integer data. Factors, on the
other hand, have this information built in. It is particularly helpful
when there are many levels (like the species names in our example
dataset).</p>
<div id="challenge-2" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-2" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-2"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li><p>Change the columns <code>taxa</code> and <code>genus</code> in
the <code>surveys</code> data frame into a factor.</p></li>
<li><p>Using the functions you learned before, can you find
out…</p></li>
</ol><ul><li>How many rabbits were observed?</li>
<li>How many different genera are in the <code>genus</code> column?</li>
</ul></div>
</div>
</div>
<div id="accordionSolution3" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution3" aria-expanded="false" aria-controls="collapseSolution3">
  <h4 class="accordion-header" id="headingSolution3">Show me the solution</h4>
</button>
<div id="collapseSolution3" class="accordion-collapse collapse" data-bs-parent="#accordionSolution3" aria-labelledby="headingSolution3">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span><span class="op">$</span><span class="va">taxa</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">taxa</span><span class="op">)</span></span>
<span><span class="va">surveys</span><span class="op">$</span><span class="va">genus</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">genus</span><span class="op">)</span></span>
<span><span class="fu">summary</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span>
<span><span class="fu">nlevels</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">genus</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## * how many genera: There are 26 unique genera in the `genus` column.</span></span>
<span><span class="co">## * how many rabbts: There are 75 rabbits in the `taxa` column.</span></span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="converting-factors">Converting factors<a class="anchor" aria-label="anchor" href="#converting-factors"></a></h3>
<p>If you need to convert a factor to a character vector, you use
<code>as.character(x)</code>.</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">as.character</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<p>In some cases, you may have to convert factors where the levels
appear as numbers (such as concentration levels or years) to a numeric
vector. For instance, in one part of your analysis the years might need
to be encoded as factors (e.g., comparing average weights across years)
but in another part of your analysis they may need to be stored as
numeric values (e.g., doing math operations on the years). This
conversion from factor to numeric is a little trickier. The
<code>as.numeric()</code> function returns the index values of the
factor, not its levels, so it will result in an entirely new (and
unwanted in this case) set of numbers. One method to avoid this is to
convert factors to characters, and then to numbers.</p>
<p>Another method is to use the <code>levels()</code> function.
Compare:</p>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">year_fct</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="fl">1990</span>, <span class="fl">1983</span>, <span class="fl">1977</span>, <span class="fl">1998</span>, <span class="fl">1990</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span>               <span class="co"># Wrong! And there is no warning...</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">as.character</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span><span class="op">)</span> <span class="co"># Works...</span></span>
<span><span class="fu">as.numeric</span><span class="op">(</span><span class="fu">levels</span><span class="op">(</span><span class="va">year_fct</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">year_fct</span><span class="op">]</span>    <span class="co"># The recommended way.</span></span></code></pre>
</div>
<p>Notice that in the <code>levels()</code> approach, three important
steps occur:</p>
<ul><li>We obtain all the factor levels using
<code>levels(year_fct)</code>
</li>
<li>We convert these levels to numeric values using
<code>as.numeric(levels(year_fct))</code>
</li>
<li>We then access these numeric values using the underlying integers of
the vector <code>year_fct</code> inside the square brackets</li>
</ul></div>
<div class="section level3">
<h3 id="renaming-factors">Renaming factors<a class="anchor" aria-label="anchor" href="#renaming-factors"></a></h3>
<p>When your data is stored as a factor, you can use the
<code>plot()</code> function to get a quick glance at the number of
observations represented by each factor level. Let’s look at the number
of males and females captured over the course of the experiment:</p>
<div class="codewrapper sourceCode" id="cb27">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## bar plot of the number of females and males captured during the experiment:</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02-starting-with-data-rendered-unnamed-chunk-27-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><p>However, as we saw when we used <code>summary(surveys$sex)</code>,
there are about 1700 individuals for which the sex information hasn’t
been recorded. To show them in the plot, we can turn the missing values
into a factor level with the <code>addNA()</code> function. We will also
have to give the new factor level a label. We are going to work with a
copy of the <code>sex</code> column, so we’re not modifying the working
copy of the data frame:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">$</span><span class="va">sex</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] "F" "M"</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb30">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">addNA</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] "F" "M" NA</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] M    M    &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; &lt;NA&gt;</span></span>
<span><span class="co">#&gt; Levels: F M &lt;NA&gt;</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"undetermined"</span></span>
<span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] "F"            "M"            "undetermined"</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb36">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">head</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; [1] M            M            undetermined undetermined undetermined</span></span>
<span><span class="co">#&gt; [6] undetermined</span></span>
<span><span class="co">#&gt; Levels: F M undetermined</span></span></code></pre>
</div>
<p>Now we can plot the data again, using <code>plot(sex)</code>.</p>
<figure><img src="fig/02-starting-with-data-rendered-unnamed-chunk-29-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure><div id="challenge-3" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="challenge-3" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-3"></a>
</h3>
<div class="callout-content">
<ul><li>Rename “F” and “M” to “female” and “male” respectively.</li>
<li>Now that we have renamed the factor level to “undetermined”, can you
recreate the barplot such that “undetermined” is first (before
“female”)?</li>
</ul></div>
</div>
</div>
<div id="accordionSolution4" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution4" aria-expanded="false" aria-controls="collapseSolution4">
  <h4 class="accordion-header" id="headingSolution4">Show me the solution</h4>
</button>
<div id="collapseSolution4" class="accordion-collapse collapse" data-bs-parent="#accordionSolution4" aria-labelledby="headingSolution4">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">levels</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">c</span><span class="op">(</span><span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span></span>
<span><span class="va">sex</span> <span class="op">&lt;-</span> <span class="fu">factor</span><span class="op">(</span><span class="va">sex</span>, levels <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"undetermined"</span>, <span class="st">"female"</span>, <span class="st">"male"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">plot</span><span class="op">(</span><span class="va">sex</span><span class="op">)</span></span></code></pre>
</div>
<figure><img src="fig/02-starting-with-data-rendered-unnamed-chunk-30-1.png" style="display: block; margin: auto;" class="figure mx-auto d-block"></figure></div>
</div>
</div>
</div>
<div id="challenge-4" class="callout discussion">
<div class="callout-square">
<i class="callout-icon" data-feather="message-circle"></i>
</div>
<div id="challenge-4" class="callout-inner">
<h3 class="callout-title">Challenge<a class="anchor" aria-label="anchor" href="#challenge-4"></a>
</h3>
<div class="callout-content">
<ol style="list-style-type: decimal"><li>We have seen how data frames are created when using
<code>read_csv()</code>, but they can also be created by hand with the
<code>data.frame()</code> function. There are a few mistakes in this
hand-crafted <code>data.frame</code>. Can you spot and fix them? Don’t
hesitate to experiment!</li>
</ol><div class="codewrapper sourceCode" id="cb39">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="sourceCode r" tabindex="0"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a>animal_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a>          <span class="at">animal =</span> <span class="fu">c</span>(dog, cat, sea cucumber, sea urchin),</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a>          <span class="at">feel =</span> <span class="fu">c</span>(<span class="st">"furry"</span>, <span class="st">"squishy"</span>, <span class="st">"spiny"</span>),</span>
<span id="cb39-4"><a href="#cb39-4" tabindex="-1"></a>          <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">45</span>, <span class="dv">8</span> <span class="fl">1.1</span>, <span class="fl">0.8</span>)</span>
<span id="cb39-5"><a href="#cb39-5" tabindex="-1"></a>          )</span></code></pre>
</div>
<ol start="2" style="list-style-type: decimal"><li>Can you predict the class for each of the columns in the following
example? Check your guesses using
<code>str(country_climate)</code>:</li>
</ol><ul><li>Are they what you expected? Why? Why not?</li>
<li>What would you need to change to ensure that each column had the
accurate data type?</li>
</ul><div class="codewrapper sourceCode" id="cb40">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">country_climate</span> <span class="op">&lt;-</span> <span class="fu">data.frame</span><span class="op">(</span></span>
<span>       country <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"Canada"</span>, <span class="st">"Panama"</span>, <span class="st">"South Africa"</span>, <span class="st">"Australia"</span><span class="op">)</span>,</span>
<span>       climate <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="st">"cold"</span>, <span class="st">"hot"</span>, <span class="st">"temperate"</span>, <span class="st">"hot/temperate"</span><span class="op">)</span>,</span>
<span>       temperature <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">30</span>, <span class="fl">18</span>, <span class="st">"15"</span><span class="op">)</span>,</span>
<span>       northern_hemisphere <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="st">"FALSE"</span><span class="op">)</span>,</span>
<span>       has_kangaroo <span class="op">=</span> <span class="fu">c</span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="fl">1</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre>
</div>
</div>
</div>
</div>
<p>The automatic conversion of data type is sometimes a blessing,
sometimes an annoyance. Be aware that it exists, learn the rules, and
double check that data you import in R are of the correct type within
your data frame. If not, use it to your advantage to detect mistakes
that might have been introduced during data entry (for instance, a
letter in a column that should only contain numbers).</p>
<p>Learn more in this <a href="https://support.rstudio.com/hc/en-us/articles/218611977-Importing-Data-with-RStudio" class="external-link">RStudio
tutorial</a></p>
</div>
</section><section id="formatting-dates"><h2 class="section-heading">Formatting dates<a class="anchor" aria-label="anchor" href="#formatting-dates"></a>
</h2>
<hr class="half-width"><p>A common issue that new (and experienced!) R users have is converting
date and time information into a variable that is suitable for analyses.
One way to store date information is to store each component of the date
in a separate column. Using <code>str()</code>, we can confirm that our
data frame does indeed have a separate column for day, month, and year,
and that each of these columns contains integer values.</p>
<div class="codewrapper sourceCode" id="cb41">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span></span></code></pre>
</div>
<p>We are going to use the <code>ymd()</code> function from the package
<strong><code>lubridate</code></strong> (which belongs to the
<strong><code>tidyverse</code></strong>; learn more <a href="https://www.tidyverse.org/" class="external-link">here</a>).
<strong><code>lubridate</code></strong> gets installed as part as the
<strong><code>tidyverse</code></strong> installation. When you load the
<strong><code>tidyverse</code></strong>
(<code><a href="https://tidyverse.tidyverse.org" class="external-link">library(tidyverse)</a></code>), the core packages (the packages used
in most data analyses) get loaded.
<strong><code>lubridate</code></strong> however does not belong to the
core tidyverse, so you have to load it explicitly with
<code><a href="https://lubridate.tidyverse.org" class="external-link">library(lubridate)</a></code></p>
<p>Start by loading the required package:</p>
<div class="codewrapper sourceCode" id="cb42">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">lubridate</span><span class="op">)</span></span></code></pre>
</div>
<p>The <strong><code>lubridate</code></strong> package has many useful
functions for working with dates. These can help you extract dates from
different string representations, convert between timezones, calculate
time differences and more. You can find an overview of them in the <a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/lubridate.pdf" class="external-link">lubridate
cheat sheet</a>.</p>
<p>Here we will use the function <code>ymd()</code>, which takes a
vector representing year, month, and day, and converts it to a
<code>Date</code> vector. <code>Date</code> is a class of data
recognized by R as being a date and can be manipulated as such. The
argument that the function requires is flexible, but, as a best
practice, is a character vector formatted as “YYYY-MM-DD”.</p>
<p>Let’s create a date object and inspect the structure:</p>
<div class="codewrapper sourceCode" id="cb43">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="st">"2015-01-01"</span><span class="op">)</span></span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">my_date</span><span class="op">)</span></span></code></pre>
</div>
<p>Now let’s paste the year, month, and day separately - we get the same
result:</p>
<div class="codewrapper sourceCode" id="cb44">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># sep indicates the character to use to separate each component</span></span>
<span><span class="va">my_date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="st">"2015"</span>, <span class="st">"1"</span>, <span class="st">"1"</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="fu">str</span><span class="op">(</span><span class="va">my_date</span><span class="op">)</span></span></code></pre>
</div>
<p>Now we apply this function to the surveys dataset. Create a character
vector from the <code>year</code>, <code>month</code>, and
<code>day</code> columns of <code>surveys</code> using
<code>paste()</code>:</p>
<div class="codewrapper sourceCode" id="cb45">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">paste</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">year</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">month</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span></span></code></pre>
</div>
<p>This character vector can be used as the argument for
<code>ymd()</code>:</p>
<div class="codewrapper sourceCode" id="cb46">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">ymd</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">year</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">month</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code><span><span class="co">#&gt; Warning: 129 failed to parse.</span></span></code></pre>
</div>
<p>There is a warning telling us that some dates could not be parsed
(understood) by the <code>ymd()</code> function. For these dates, the
function has returned <code>NA</code>, which means they are treated as
missing values. We will deal with this problem later, but first we add
the resulting <code>Date</code> vector to the <code>surveys</code> data
frame as a new column called <code>date</code>:</p>
<div class="codewrapper sourceCode" id="cb48">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">surveys</span><span class="op">$</span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu">ymd</span><span class="op">(</span><span class="fu">paste</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">year</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">month</span>, <span class="va">surveys</span><span class="op">$</span><span class="va">day</span>, sep <span class="op">=</span> <span class="st">"-"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">WARNING<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="warning" tabindex="0"><code><span><span class="co">#&gt; Warning: 129 failed to parse.</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb50">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">str</span><span class="op">(</span><span class="va">surveys</span><span class="op">)</span> <span class="co"># notice the new column, with 'date' as the class</span></span></code></pre>
</div>
<p>Let’s make sure everything worked correctly. One way to inspect the
new column is to use <code>summary()</code>:</p>
<div class="codewrapper sourceCode" id="cb51">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">summary</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">date</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt;         Min.      1st Qu.       Median         Mean      3rd Qu.         Max. </span></span>
<span><span class="co">#&gt; "1977-07-16" "1984-03-12" "1990-07-22" "1990-12-15" "1997-07-29" "2002-12-31" </span></span>
<span><span class="co">#&gt;         NA's </span></span>
<span><span class="co">#&gt;        "129"</span></span></code></pre>
</div>
<p>Let’s investigate why some dates could not be parsed.</p>
<p>We can use the functions we saw previously to deal with missing data
to identify the rows in our data frame that are failing. If we combine
them with what we learned about subsetting data frames earlier, we can
extract the columns “year,”month”, “day” from the records that have
<code>NA</code> in our new column <code>date</code>. We will also use
<code>head()</code> so we don’t clutter the output:</p>
<div class="codewrapper sourceCode" id="cb53">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">missing_dates</span> <span class="op">&lt;-</span> <span class="va">surveys</span><span class="op">[</span><span class="fu">is.na</span><span class="op">(</span><span class="va">surveys</span><span class="op">$</span><span class="va">date</span><span class="op">)</span>, <span class="fu">c</span><span class="op">(</span><span class="st">"year"</span>, <span class="st">"month"</span>, <span class="st">"day"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu">head</span><span class="op">(</span><span class="va">missing_dates</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code><span><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span><span class="co">#&gt;    year month   day</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  2000     9    31</span></span>
<span><span class="co">#&gt; 2  2000     4    31</span></span>
<span><span class="co">#&gt; 3  2000     4    31</span></span>
<span><span class="co">#&gt; 4  2000     4    31</span></span>
<span><span class="co">#&gt; 5  2000     4    31</span></span>
<span><span class="co">#&gt; 6  2000     9    31</span></span></code></pre>
</div>
<p>Why did these dates fail to parse? If you had to use these data for
your analyses, how would you deal with this situation?</p>
<p>The answer is because the dates provided as input for the
<code>ymd()</code> function do not actually exist. If we refer to the
output we got above, September and April only have 30 days, not 31 days
as it is specified in our dataset.</p>
<p>There are several ways you could deal with situation:</p>
<ul><li>If you have access to the raw data (e.g., field sheets) or
supporting information (e.g., field trip reports/logs), check them and
ensure the electronic database matches the information in the original
data source.</li>
<li>If you are able to contact the person responsible for collecting the
data, you could refer to them and ask for clarification.</li>
<li>You could also check the rest of the dataset for clues about the
correct value for the erroneous dates.</li>
<li>If your project has guidelines on how to correct this sort of
errors, refer to them and apply any recommendations.</li>
<li>If it is not possible to ascertain the correct value for these
observations, you may want to leave them as missing data.</li>
</ul><p>Regardless of the option you choose, it is important that you
document the error and the corrections (if any) that you apply to your
data.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul><li>Use <code>read.csv</code> to read tabular data in R.</li>
<li>A data frame is the representation of data in the format of a table
where the columns are vectors that all have the same length.</li>
<li>
<code>dplyr</code> provides many methods for inspecting and
summarizing data in data frames.</li>
<li>Use factors to represent categorical data in R.</li>
<li>The <strong><code>lubridate</code></strong> package has many useful
functions for working with dates.</li>
</ul></div>
</div>
</div>
</section></div> <!-- / div.lesson-content -->
    </main><!-- / main#main-content.main-content --><nav class="bottom-pagination mx-md-4" aria-label="Previous and Next Chapter"><div class="d-block d-sm-block d-md-none">
        <a class="chapter-link" href="01-intro-to-r.html"><i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>Previous</a>
        <a class="chapter-link float-end" href="03-dplyr.html">Next<i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i></a>
      </div>
      <!-- content for large screens -->
      <div class="d-none d-sm-none d-md-block">
        <a class="chapter-link" href="01-intro-to-r.html" rel="prev">
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-left"></i>
          Previous: Introduction to R
        </a>
        <a class="chapter-link float-end" href="03-dplyr.html" rel="next">
          Next: Manipulating,... 
          <i aria-hidden="true" class="small-arrow" data-feather="arrow-right"></i>
        </a>
      </div>
    </nav></div> <!-- / div.primary-content.col-xs-12 -->
<!-- END:   inst/pkgdown/templates/content-instructor.html-->

      </div><!--/div.row-->
      		<footer class="row footer mx-md-3"><hr><div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>
        
        <a href="https://github.com/datacarpentry/R-ecology-lesson/edit/main/episodes/02-starting-with-data.Rmd" class="external-link">Edit on GitHub</a>
        
	
        | <a href="https://github.com/datacarpentry/R-ecology-lesson/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/datacarpentry/R-ecology-lesson/" class="external-link">Source</a></p>
				<p><a href="https://github.com/datacarpentry/R-ecology-lesson/blob/main/CITATION" class="external-link">Cite</a> | <a href="mailto:curriculum@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">
        
        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>
        
        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.3" class="external-link">sandpaper (0.16.3)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.4" class="external-link">pegboard (0.7.4)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.1" class="external-link">varnish (1.0.1)</a></p>
			</div>
		</footer></div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://datacarpentry.github.io/R-ecology-lesson/02-starting-with-data.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "Starting with data",
  "creativeWorkStatus": "active",
  "url": "https://datacarpentry.github.io/R-ecology-lesson/02-starting-with-data.html",
  "identifier": "https://datacarpentry.github.io/R-ecology-lesson/02-starting-with-data.html",
  "dateCreated": "2015-04-02",
  "dateModified": "2024-03-12",
  "datePublished": "2024-03-26"
}

  </script><script>
		feather.replace();
	</script><!-- Matomo
    2022-11-07: we have gotten a notification that we have an overage for our
    tracking and I'm pretty sure this has to do with Workbench usage.
    Considering that I am not _currently_ using this tracking because I do not
    yet know how to access the data, I am turning this off for now.
  <script>
    var _paq = window._paq = window._paq || [];
    /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setDomains", ["*.preview.carpentries.org","*.datacarpentry.github.io","*.datacarpentry.org","*.librarycarpentry.github.io","*.librarycarpentry.org","*.swcarpentry.github.io", "*.carpentries.github.io"]]);
    _paq.push(["setDoNotTrack", true]);
    _paq.push(["disableCookies"]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);
    (function() {
          var u="https://carpentries.matomo.cloud/";
          _paq.push(['setTrackerUrl', u+'matomo.php']);
          _paq.push(['setSiteId', '1']);
          var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
          g.async=true; g.src='https://cdn.matomo.cloud/carpentries.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);
        })();
  </script>
  End Matomo Code --></body></html><!-- END:   inst/pkgdown/templates/layout.html-->

